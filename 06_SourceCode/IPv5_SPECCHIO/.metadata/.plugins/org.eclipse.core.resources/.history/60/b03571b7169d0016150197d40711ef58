package ch.specchio.util;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

import ch.specchio.client.SPECCHIOClient;
import ch.specchio.client.SPECCHIOClientException;
import ch.specchio.client.SPECCHIOClientFactory;
import ch.specchio.client.SPECCHIOServerDescriptor;
import ch.specchio.model.MetaDataObject;
import ch.specchio.types.MatlabAdaptedArrayList;

public class SpecchioUtil {
	
	SPECCHIOClient specchio_client;
	List<MetaDataObject> metaDataObjectList;
	ArrayList<Integer> ids;
	
	public SpecchioUtil(ArrayList<Integer> ids) throws SPECCHIOClientException, FileNotFoundException, IOException {
		SPECCHIOClientFactory cf = SPECCHIOClientFactory.getInstance();
		List<SPECCHIOServerDescriptor> db_descriptor_list = cf.getAllServerDescriptors();
		this.specchio_client = cf.createClient(db_descriptor_list.get(0));
		this.ids = ids;
		initMetaDataObjectList();
	}
	
	private void initMetaDataObjectList(){
		metaDataObjectList = new LinkedList<MetaDataObject>();
		for(int i = 0; i < ids.size(); i++){
			metaDataObjectList.add(new MetaDataObject());
		}
	}
	
	public void fillFileNames(){
		MatlabAdaptedArrayList<Object> resultList = getMetaparameterValues(ids, "File Name");
		for(int i = 0; i < resultList.size(); i++){
			MetaDataObject metaDO = metaDataObjectList.get(i);
			metaDO.setFilename(resultList.get(i).toString());
		}
	}
	
	public void fillAcquisitionTime(){
		MatlabAdaptedArrayList<Object> resultList = getMetaparameterValues(ids, "Acquisition Time");
		for(int i = 0; i < resultList.size(); i++){
			MetaDataObject metaDO = metaDataObjectList.get(i);
			metaDO.setAcquisitionTime(resultList.get(i).toString());
		}
	}
	
	public void fillCampaignName(){
		MatlabAdaptedArrayList<Object> resultList = getMetaparameterValues(ids, "Campaign Name");
		for(int i = 0; i < resultList.size(); i++){
			MetaDataObject metaDO = metaDataObjectList.get(i);
			metaDO.setCampaignName(resultList.get(i).toString());
		}
	}
	
	public void fillInvestigator(){
		MatlabAdaptedArrayList<Object> resultList = getMetaparameterValues(ids, "Investigator");
		for(int i = 0; i < resultList.size(); i++){
			MetaDataObject metaDO = metaDataObjectList.get(i);
			metaDO.setAcquisitionTime(resultList.get(i).toString());
		}
	}
	
	private String campaignName;
	private String investigator;
	
	
	public MatlabAdaptedArrayList<Object> getMetaparameterValues(ArrayList<Integer> ids, String metaparameter){
		return specchio_client.getMetaparameterValues(ids, metaparameter);
		
	}


	public List<MetaDataObject> getMetaDataObjectList() {
		return metaDataObjectList;
	}
	
}
